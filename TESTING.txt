# Test: Identifying core-periphery structures (dependency and p-core)

# Delete any existing structures
deleteall()

# Set random seed
randomseed(6031769)

# Load matrix Hlebec notesharing
loadmatrix(file = "example_data/zachary.txt")

# Initialize and start the core-periphery search, using peripheral dependency patterns
# and a p-core with p=0.60:
coreperi(network = zachary, searchtype = ljubljana, powerrelational = dep, core = pco(0.60) )

# Initialize the search: use ljubljana search algorithm and weighted-correlation gof
bminit(network = hlebec, blockimage = bi3re, searchtype = ljubljana, method = nordlund)

# Start the search
bmstart()

# Display the blockmodel (should yield a single one)
bmview(blockmodel = bm_hlebec_bi3re_19_0)

# The optimal partition should be:
# (4,8,9)
# (2,10)
# (1,3,5,6,7,11,12,13)

# The optimal goodness-of-fit should be:
# 0.8813 (nordlund)